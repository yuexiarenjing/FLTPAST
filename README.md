# FLTPASTï¼šFunction Level Trace Point Selection Tool

A tool to automatically generate function level trace points which can optimize the tracing overhead and structural coverage.

## Require

1. SystemTap (https://sourceware.org/systemtap/)

2. Python 3

3. Java development toolkit

## How to use

1. preprocess: prepare the necessary data obtained from the static analysis of the program.
   
   1.1 get fun_count.out file by get_fun_count.stp 
   ```
   stap -v get_fun_count.stp -o fun_count.out
   ```
   
   1.2 get LLVM-IR files by getll.sh
   ```
   # run in the source directory of the target program.
   bash getll.sh
   ```
   
   1.3 get probe_functions by command: stap -L 'process("/path/to/binary").function("*")' > probe_functions
   ```
   stap -L 'process("/path/to/binary").function("*")' > probe_functions
   ```
   
   1.4 run mmas.py to generate fun_blocks.txt and fun_weight.txt (store into input dir)
   ```
   python mmas.py
   ```

2. solver: solve the MWSCP problem to generate the optimal set of trace points.
   
   2.1 prepare the input dir, the files needed has been generated by step 1.4
   ```
   # the required files have already been placed as follows.
   ls /path/to/solver/input/<target_program>
   ```
   
   2.2 run MWSCP.java, the trace point will be generated into output dir

3. tracer: obtain the trace script and execute the tracing process.
   
   3.1 prepare the output dir, the files needed has been generated by step 2.2
   ```
   # the required files have already been placed as follows.
   ls /path/to/tracer/input/<target_program>
   ```
   
   3.2 run adaptive_trace.py to generate the systemtap tracing script.
   ```
   python adaptive_trace.py
   ```
   
   3.3 run the stp script, e.g., stap -v trace_functions-0.01.stp -o out
   ```
   stap -v trace_functions-0.01.stp -o <output_file>
   # after running the target program, the trace results will be saved to the output file.
   ```


## About the dataset

The dataset associated with this project is available at https://dx.doi.org/10.21227/7n40-bm26.
